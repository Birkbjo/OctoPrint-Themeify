var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[a]=b.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var a=0;return $jscomp.iteratorPrototype(function(){return a<c.length?{done:!1,value:c[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(c,a){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var b=0,e={next:function(){if(b<c.length){var d=b++;return{value:a(d,c[d]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(c,a,b,e){if(a){b=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var d=c[e];d in b||(b[d]={});b=b[d]}c=c[c.length-1];e=b[c];a=a(e);a!=e&&null!=a&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$(function(){OCTOPRINT_VIEWMODELS.push([function(c){var a=this;a.classId="themeify";a.settings=c[0];a.ownSettings={};a.customRules=[];a.customizedElements=[];a.builtInElements=[];a._ownSettingsPrev={};a.configSubscriptions={enabled:"",theme:"",nightTheme:""};a.onStartupComplete=function(){var b=$("html").attr("id");b&&"touch"==b&&$("html").removeClass(a.classId);a.updateColors();a._updateCustomRules()};a.enable=function(){var b=(new Date).getHours();a.ownSettings.enabled()&&$.attr("html","class")!=
a.classId&&"touch"!==$("html").attr("id")&&($("html").addClass(a.classId),a.ownSettings.enableAutoswitch()&&(b>=a.ownSettings.nightTimeStart()||b<a.ownSettings.nightTimeEnd())?$("html").addClass(a.ownSettings.nightTheme()):$("html").addClass(a.ownSettings.theme()))};a.addNewCustomRule=function(){var b={selector:ko.observable(""),rule:ko.observable(""),value:ko.observable(""),enabled:ko.observable(!0)};a._subscribeToCustomRules(b,"customRules");a.ownSettings.customRules.push(b)};a.onBeforeBinding=
function(){a.settings=a.settings.settings;a.ownSettings=a.settings.plugins.themeify;a.customRules=a.ownSettings.customRules.extend({rateLimit:50});a.onRuleToggle=a.onRuleToggle;a.enable();a._copyOwnSettings()};a.updateColors=function(){a._removeBuiltInStyles();a.ownSettings.enableCustomization()&&a.ownSettings.color().filter(function(a){return!!a.enabled()}).map(function(b,e){a._applyRule(b,!0)})};a._updateCustomRules=function(){a._removeCustomStyles();a.updateColors();a.ownSettings.enableCustomization()&&
a.ownSettings.customRules().filter(function(a){return!!a.enabled()}).map(function(b){a._applyRule(b)})};a._applyRule=function(b,e){e=void 0===e?!1:e;var c=$(b.selector()),f=c.css(b.rule());e?a.builtInElements.push({elem:c,rule:b.rule(),old:f}):a.customizedElements.push({elem:c,rule:b.rule(),old:f});$(b.selector()).css(b.rule(),b.value())};a.clone=function(b){if("function"==typeof b)return b();if(null===b||"object"!==typeof b||"isActiveClone"in b)return b;var c=b instanceof Date?new b.constructor:
b.constructor(),d;for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(b.isActiveClone=null,c[d]=a.clone(b[d]),delete b.isActiveClone);return c};a._copyOwnSettings=function(){Object.keys(a.ownSettings).forEach(function(b,c){a._ownSettingsPrev[b]=a.clone(a.ownSettings[b])})};a.onChange=function(b,c){a.updateColors();a._copyOwnSettings()};a.onColorChange=function(b,c){a.updateColors();a._copyOwnSettings()};a.onCustomRuleChange=function(b){a.updateColors();b.rule()&&b.selector()&&b.value()&&a._updateCustomRules()};
a.onThemeChange=function(b){var c=a._ownSettingsPrev.theme,d=(new Date).getHours();$("html").hasClass(b)||d>=a.ownSettings.nightTimeStart()||d<a.ownSettings.nightTimeEnd()||$("html").addClass(b).removeClass(c);a._copyOwnSettings()};a.onNightThemeChange=function(b){var c=a._ownSettingsPrev.nightTheme,d=(new Date).getHours();!$("html").hasClass(b)&&(d>=a.ownSettings.nightTimeStart()||d<a.ownSettings.nightTimeEnd())&&$("html").addClass(b).removeClass(c);a._copyOwnSettings()};a.onNightTimeStartChange=
function(b){a._autoCheck();a._copyOwnSettings()};a.onNightTimeEndChange=function(b){a._autoCheck();a._copyOwnSettings()};a.onEnabledChange=function(b){b&&$.attr("html","class")!=a.classId&&"touch"!==$("html").attr("id")?$("html").addClass(a.classId):($("html").removeClass(a.classId),a._removeCustomStyles());a._copyOwnSettings()};a.onEnableCustomizationChange=function(b){b&&a.ownSettings.enabled()&&a.ownSettings.enableCustomization?(a.updateColors(),a._updateCustomRules()):b||(a._removeBuiltInStyles(),
a._removeCustomStyles());a._copyOwnSettings()};a.onEnableAutoswitchChange=function(b){a._autoCheck();a._copyOwnSettings()};a._removeCustomStyles=function(){a.customizedElements.map(function(a){return a.elem.css(a.rule,"")})};a._removeBuiltInStyles=function(){a.builtInElements.map(function(a){return a.elem.css(a.rule,"")})};a._removeCustomStylesByRule=function(a){$(a.selector()).css(a.rule(),"")};a.onRuleToggle=function(a){a.enabled(!a.enabled())};a.ruleIsDeleteable=function(a){return a.deletable&&
"function"===typeof a.deletable?a.deletable():!0};a.onCustomRuleDelete=function(b){a.ruleIsDeleteable(b)&&(a.customRules.remove(b),a._updateCustomRules())};a._subscribeToCustomRules=function(b,c,d){var e=d?d.bind(this,b):a.onCustomRuleChange.bind(this,b);Object.keys(b).map(function(d){a.configSubscriptions[c].push(b[d].subscribe(e))})};a.onSettingsShown=function(){var b=this;Object.keys(a.ownSettings).map(function(c,d){if("customRules"==c)a.configSubscriptions[c]=[],a.customRules().map(function(b,
d){a._subscribeToCustomRules(b,c)});else if("color"==c){a.configSubscriptions[c]=[];var e=a.onColorChange;a.ownSettings.color().map(function(b,d){a._subscribeToCustomRules(b,c,e)})}else{var g=a.configOnChangeMap[c]?a.configOnChangeMap[c]:a.onChange.bind(b,c);a.configSubscriptions[c]=a.ownSettings[c].subscribe(g)}})};a._timer=function(){a.ownSettings.enabled()&&a.ownSettings.enableAutoswitch()&&(a._autoCheck(),setTimeout(function(){a._timer},36E5))};a._autoCheck=function(){var b=(new Date).getHours();
a.ownSettings.enabled()&&$.attr("html","class")!=a.classId&&"touch"!==$("html").attr("id")&&a.ownSettings.enableAutoswitch()&&((b>=a.ownSettings.nightTimeStart()||b<a.ownSettings.nightTimeEnd())&&!$("html").hasClass(a.ownSettings.nightTheme())?$("html").addClass(a.ownSettings.nightTheme()).removeClass(a.ownSettings.theme()):b>=a.ownSettings.nightTimeStart()||b<a.ownSettings.nightTimeEnd()||$("html").hasClass(a.ownSettings.theme())||$("html").addClass(a.ownSettings.theme()).removeClass(a.ownSettings.nightTheme()))};
a.onSettingsHidden=function(){Object.keys(a.configSubscriptions).map(function(b,c){Array.isArray(a.configSubscriptions[b])?a.configSubscriptions[b].forEach(function(a){a.dispose()}):a.configSubscriptions[b].dispose()})};a.configOnChangeMap={enabled:a.onEnabledChange,theme:a.onThemeChange,nightTheme:a.onNightThemeChange,nightTimeStart:a.onNightTimeStartChange,nightTimeEnd:a.onNightTimeEndChange,enableCustomization:a.onEnableCustomizationChange,enableAutoswitch:a.onEnableAutoswitchChange}},["settingsViewModel"],
["#settings_plugin_themeify"]])});
